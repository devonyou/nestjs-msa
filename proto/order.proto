syntax = "proto3";

package order;

// import "google/protobuf/timestamp.proto";

service OrderService {
	rpc CreateOrder(CreateOrderRequest) returns (OrderResponse);
	rpc GetOrderByIdAndUser(GetOrderByIdAndUserRequest) returns (OrderResponse);
	rpc GetOrdersByUserId(GetOrdersByUserIdRequest) returns (OrderListResponse);
	rpc UpdateOrderStatus(UpdateOrderStatusRequest) returns (OrderResponse);
}

message Order {
	string id = 1;
	int32 userId = 2;
	int32 amount = 3;
	OrderStatus status = 4;
	repeated OrderItem orderItems = 5;
	DeliveryResponse delivery = 6;
	string paymentId = 7;
}

message OrderItem {
	int32 id = 1;
	int32 productId = 2;
	string productName = 3;
	int32 quantity = 4;
	int32 price = 5;
}

message Delivery {
	int32 id = 1;
	string orderId = 2;
	string postCode = 3;
	string street = 4;
}

// response
message OrderResponse {
	string id = 1;
	int32 userId = 2;
	int32 amount = 3;
	OrderStatus status = 4;
	repeated OrderItemResponse orderItems = 5;
	DeliveryResponse delivery = 6;
	string paymentId = 7;
	string createdAt = 8;
	string updatedAt = 9;
}

message OrderListResponse {
	repeated OrderResponse orders = 1;
}

message OrderItemResponse {
	int32 id = 1;
	int32 productId = 2;
	string productName = 3;
	int32 quantity = 4;
	int32 price = 5;
}

message DeliveryResponse {
	int32 id = 1;
	string orderId = 2;
	string postCode = 3;
	string street = 4;
}

// create order
message CreateOrderRequest {
	int32 userId = 1;
	repeated OrderItemRequest items = 2;
	DeliveryRequest delivery = 3;
}

message OrderItemRequest {
	int32 productId = 1;
	int32 quantity = 2;
}

message DeliveryRequest {
	string postCode = 1;
	string street = 2;
}

message GetOrderByIdAndUserRequest {
	string orderId = 1;
	int32 userId = 2;
}

message GetOrdersByUserIdRequest {
	int32 userId = 1;
}

message UpdateOrderStatusRequest {
	string orderId = 1;
	int32 userId = 2;
	OrderStatus status = 3;
}

enum OrderStatus {
	CREATED = 0;
	STOCK_RESERVED = 1;
	PAYMENT_PENDING = 2;
	PAYMENT_SUCCESS = 3;
	PAYMENT_FAILED = 4;
	CANCELED = 5;
	SHIPPED = 6;
	COMPLETED = 7;
}

// enum DeliveryStatus {
// 	PENDING = 0;
// 	SHIPPED = 1;
// 	IN_TRANSIT = 2;
// 	DELIVERED = 3;
// 	FAILED = 4;
// 	RETURNED = 5;
// 	CANCELED = 6;
// }
